{# templates/proj/edu/index.html.twig #}
{% extends 'proj/base.html.twig' %}

{% block title %}EduTracker{% endblock %}

{% block library_body %}
<section class="edu-container">

    {# Header #}
    <div class="edu-header">
        <h1>EduTracker</h1>
        <p>Track your learning progress effectively!</p>
        <a href="{{ path('edu_create') }}" class="btn btn-primary">
            Add New Learning Item
        </a>
    </div>

    {# Grid of learning items #}
    <div class="edu-grid">
        {% for item in items %}
            <div class="edu-card">

                {# Status badge #}
                <span class="status {{ item.status|replace({' ':'-'}) }}">
                    {{ item.status|capitalize }}
                </span>

                {# Title #}
                <h2>{{ item.title }}</h2>

                {# Short description #}
                <p>
                    {{ item.description|length > 150
                        ? item.description|slice(0, 150) ~ '...'
                        : item.description
                    }}
                </p>

                {# Card footer actions #}
                <div class="edu-card-footer actions">

                    {# VIEW – đi tới trang show #}
                    <a href="{{ path('edu_show', {'id': item.id}) }}"
                       class="btn btn-primary small">
                        View
                    </a>

                    {# External URL #}
                    {% if item.url %}
                        {% set url = item.url|trim %}
                        {% if not (url starts with 'http://' or url starts with 'https://') %}
                            {% set url = 'https://' ~ url %}
                        {% endif %}
                        <a href="{{ url }}"
                           target="_blank"
                           rel="noopener noreferrer"
                           class="btn btn-outline small">
                            Go to Resource
                        </a>
                    {% endif %}

                    {# Edit #}
                    <a href="{{ path('edu_edit', {'id': item.id}) }}"
                       class="btn btn-outline small">
                        Edit
                    </a>

                    {# Delete #}
                    <form method="post"
                          action="{{ path('edu_delete', {'id': item.id}) }}"
                          style="display:inline;"
                          onsubmit="return confirm('Are you sure you want to delete this item?');">
                        <input type="hidden"
                               name="_token"
                               value="{{ csrf_token('delete' ~ item.id) }}">
                        <button type="submit"
                                class="btn btn-danger small">
                            Delete
                        </button>
                    </form>

                </div>
            </div>
        {% else %}
            <p>No learning items yet. Start adding your progress!</p>
        {% endfor %}
    </div>

</section>
{% endblock %}
